<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>So...WTF, then? — One True Infotainment</title>
  <meta name="description" content="Exactly. The media made the book. The book made the machine. The machine makes the media." />

  <!-- Open Graph -->
  <meta property="og:title" content="So...WTF, then?" />
  <meta property="og:description" content="Exactly. The media made the book. The book made the machine. The machine makes the media." />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="media/cover-AD.jpg" />
  <meta property="og:site_name" content="One True Infotainment" />
  <link rel="canonical" href="cover-ad.html" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="So...WTF, then?" />
  <meta name="twitter:description" content="Exactly. The media made the book. The book made the machine. The machine makes the media." />
  <meta name="twitter:image" content="media/cover-AD.jpg" />

  <link rel="stylesheet" href="style.css?v=140" />
  <script src="ticker.js" defer></script>
  <script src="ads.js" defer></script>

  <style>
    /* --- FIX 1: remove hardcoded opacity:0 so broken loads don’t render invisibly --- */
    .story-hero img { width: 100%; height: auto; border-radius: 10px; box-shadow: 0 6px 18px rgba(0,0,0,.25); transform: translateY(8px); }
    /* clickable area should be the whole image */
    .story-hero a { display: inline-block; line-height: 0; }
    /* progressive reveal handled with this class instead of default opacity:0 */
    .story-hero img.is-hidden { opacity: 0; }

    @media (min-width: 900px) {
      .story-hero img { display: block; margin: 0 auto; max-height: 62vh; width: auto; max-width: 100%; object-fit: contain; }
    }
    body.has-logo .oti-logo { position: fixed; right: 18px; bottom: 18px; width: 120px; opacity: .95; filter: drop-shadow(0 4px 12px rgba(0,0,0,.35)); }
  </style>
</head>

<body class="story-page has-logo">
  <div id="ticker" class="ticker" aria-live="polite"></div>

  <header class="site-header" role="banner">
    <a href="index.html" aria-label="Return to OTI Home">
      <img class="banner-img" src="media/banner.png" alt="ONE TRUE INFOTAINMENT — The Voice of the Corrected State" />
    </a>
  </header>

  <main class="page">
    <article>
      <figure class="story-hero wrap-left">
        <!--
          FIX 2: Ensure the hero is always a link and visibly clickable.
          Added loading="eager" and class="is-hidden" for controlled fade-in.
        -->
        <a href="https://a.co/d/g8VtxsM" target="_blank" rel="noopener">
          <img
            src="media/cover-AD.jpg"
            alt="Book cover advertisement for When It Happened Here"
            decoding="async"
            fetchpriority="high"
            loading="eager"
            class="is-hidden"
          />
        </a>
        <figcaption>Official book release advertisement.</figcaption>
      </figure>

      <header>
        <div class="kicker">Promotions • Publication</div>
        <h1>So...WTF, then?</h1>
        <p class="dek">Exactly.</p>
      </header>

      <section class="summary">
        <p>It started as satire. It became self-aware. The book that mocked the news — now makes it. Read <a href="https://a.co/d/d9GtIHl">When It Happened Here on Kindle.</a></p>
        <p></p>
      </section>

      <nav class="footer-nav" aria-label="Ad navigation">
        <a class="btn" href="ad-next.html">Next Ad →</a>
        <a class="btn" href="index.html">OTI Home</a>
      </nav>
    </article>

    <div class="ad-row"></div>
  </main>

  <footer class="footer-banner">
    The persons, events and depictions of One True Infotainment are fictional and may not yet have come to pass.
    Irony is resistance, satire a pitchfork.
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (!document.body.classList.contains('story-page')) return;
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const H = document.querySelector('article h1');
      const D = document.querySelector('article .dek');
      const I = document.querySelector('.story-hero img');

      // If motion reduced, reveal immediately (and don’t rely on image load timing)
      if (reduce) {
        [H, D, I].forEach(el => el && (el.style.opacity = 1, el.style.transform = 'translateY(0)'));
        I && I.classList.remove('is-hidden');
        return;
      }

      const fadeIn = (el, delay = 0) => el && el.animate(
        [ { opacity: 0, transform: 'translateY(8px)' }, { opacity: 1, transform: 'translateY(0)' } ],
        { duration: 600, easing: 'ease', fill: 'forwards', delay }
      );

      fadeIn(H, 0);
      fadeIn(D, 150);

      const showImage = () => { I.classList.remove('is-hidden'); fadeIn(I, 300); };

      // If already loaded (or cached), show immediately. If it errors, still unhide so the link is clickable.
      if (I && I.complete && I.naturalWidth > 0) {
        showImage();
      } else if (I) {
        I.addEventListener('load', showImage, { once: true });
        I.addEventListener('error', () => { I.classList.remove('is-hidden'); }, { once: true });
        // Failsafe: if neither event fires (e.g., blocked resource), unhide after 2s so link remains visible/clickable
        setTimeout(() => I.classList.remove('is-hidden'), 2000);
      }
    });
  </script>

  <img class="oti-logo" src="media/OTI-Logo.png" alt="OTI logo" aria-hidden="true" />
</body>
</html>
