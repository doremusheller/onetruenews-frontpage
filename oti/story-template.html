<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Page Title & Description -->
  <title>{{STORY_TITLE}} — One True Infotainment</title>
  <meta name="description" content="{{STORY_DESCRIPTION}}" />

  <!-- Open Graph -->
  <meta property="og:title" content="{{STORY_TITLE}}" />
  <meta property="og:description" content="{{STORY_DESCRIPTION}}" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="{{OG_IMAGE_SRC}}" />
  <meta property="og:site_name" content="One True Infotainment" />
  <link rel="canonical" href="{{STORY_SLUG}}.html" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{STORY_TITLE}}" />
  <meta name="twitter:description" content="{{STORY_DESCRIPTION}}" />
  <meta name="twitter:image" content="{{OG_IMAGE_SRC}}" />

  <!-- Canonical OTI styles -->
  <link rel="stylesheet" href="style.css?v=140" />

  <!-- Scripts placed in head to match GrundyMax structure -->
  <script src="ticker.js" defer></script>
  <script src="ads.js" defer></script>

  <!-- Hero alignment and animation (from GrundyMax) -->
  <style>
    .story-hero img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
      opacity: 0;
      transform: translateY(8px);
    }

    @media (min-width: 900px) {
      .story-hero img {
        display: block;
        margin: 0 auto;
        max-height: 62vh;
        width: auto;
        max-width: 100%;
        object-fit: contain;
      }
    }
  </style>
</head>

<body class="story-page">
  <!-- Live Ticker -->
  <div id="ticker" class="ticker" aria-live="polite"></div>

  <!-- Banner -->
  <header class="site-header" role="banner">
    <a href="index.html" aria-label="Return to OTI Home">
      <img
        class="banner-img"
        src="media/banner.png"
        alt="ONE TRUE INFOTAINMENT — The Voice of the Corrected State" />
    </a>
  </header>

  <main class="page">
    <article>
      <!-- Hero image -->
      <figure class="story-hero wrap-left">
        <img
          src="{{HERO_IMAGE_SRC}}"
          alt="{{HERO_IMAGE_ALT}}"
          decoding="async"
          fetchpriority="high" />
        <figcaption>{{HERO_CAPTION}}</figcaption>
      </figure>

      <!-- Header block -->
      <header>
        <div class="kicker">{{KICKER_SECTION}} • {{KICKER_SUBSECTION}}</div>
        <h1>{{STORY_TITLE}}</h1>
        <p class="dek">{{STORY_DEK}}</p>
        <p class="byline">By {{BYLINE_NAME}} — One True Infotainment</p>
        <p class="dateline">{{DATELINE_CITY}}, {{DATELINE_COUNTRY}} — {{DATELINE_DATE}}</p>
      </header>

      <!-- Navigation -->
      <nav class="footer-nav" aria-label="Story navigation (top)">
        <a class="btn" href="{{NEXT_STORY_HREF}}">Next Story →</a>
        <a class="btn" href="index.html">OTI Home</a>
      </nav>

      <!-- Body -->
      <section>
        <p>{{PARA_1}}</p>
        <p>{{PARA_2}}</p>
        <p>{{PARA_3}}</p>
      </section>

      <!-- Bottom navigation -->
      <nav class="footer-nav" aria-label="Story navigation (bottom)">
        <a class="btn" href="{{NEXT_STORY_HREF}}">Next Story →</a>
        <a class="btn" href="index.html">OTI Home</a>
      </nav>
    </article>

    <!-- Bottom ads -->
    <div class="ad-row"></div>
  </main>

  <!-- Footer -->
  <footer class="footer-banner">
    The persons, events and depictions of One True Infotainment are fictional and may not yet have come to pass.
    Irony is resistance, satire a pitchfork.
  </footer>

  <!-- Inline fade-in motion -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (!document.body.classList.contains('story-page')) return;
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const H = document.querySelector('article h1');
      const D = document.querySelector('article .dek');
      const I = document.querySelector('.story-hero img');
      if (reduce) { [H, D, I].forEach(el => el && (el.style.opacity = 1)); return; }

      const fadeIn = (el, delay = 0) => el && el.animate(
        [{ opacity: 0, transform: 'translateY(8px)' },
         { opacity: 1, transform: 'translateY(0)' }],
        { duration: 600, easing: 'ease', fill: 'forwards', delay }
      );

      fadeIn(H, 0);
      fadeIn(D, 150);
      if (I?.complete) fadeIn(I, 300);
      else I?.addEventListener('load', () => fadeIn(I, 300), { once: true });
    });
  </script>

  <!-- Optional caption fallback -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (!document.body.classList.contains("story-page")) return;
      const fig = document.querySelector(".story-hero");
      if (!fig || fig.querySelector("figcaption")) return;
      const firstP = document.querySelector("article section p");
      if (firstP) {
        const caption = document.createElement("figcaption");
        caption.textContent = firstP.textContent.slice(0, 140).trim() + "…";
        fig.appendChild(caption);
      }
    });
  </script>
</body>
</html>
